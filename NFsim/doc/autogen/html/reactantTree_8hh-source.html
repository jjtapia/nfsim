<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>NFsim: /home/msneddon/eclipse/galileoSR1_cpp/workspace/NFsim/src/NFreactions/reactantLists/reactantTree.hh Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1>/home/msneddon/eclipse/galileoSR1_cpp/workspace/NFsim/src/NFreactions/reactantLists/reactantTree.hh</h1><a href="reactantTree_8hh.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#ifndef REACTANTTREE_HH_</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">#define REACTANTTREE_HH_</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include "../NFreactions.hh"</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="keyword">namespace </span>NFcore
<a name="l00010"></a>00010 {
<a name="l00011"></a>00011         <span class="comment">//Forward Declarations</span>
<a name="l00012"></a>00012         <span class="keyword">class </span>TransformationSet;
<a name="l00013"></a>00013         <span class="keyword">class </span>MappingSet;
<a name="l00014"></a>00014         <span class="keyword">class </span>ReactantContainer;
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 
<a name="l00018"></a>00018 
<a name="l00031"></a><a class="code" href="classNFcore_1_1ReactantTree.html">00031</a>         <span class="keyword">class </span><a class="code" href="classNFcore_1_1ReactantTree.html" title="Maintains a tree of MappingSets needed by Distribution of Rates Reactions.">ReactantTree</a> : <span class="keyword">public</span> <a class="code" href="classNFcore_1_1ReactantContainer.html" title="Interface for all containers of Reactants (MappingSets) needed by ReactionClasses...">ReactantContainer</a> {
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 
<a name="l00034"></a>00034                 <span class="keyword">public</span>:
<a name="l00035"></a>00035 
<a name="l00041"></a>00041                         <a class="code" href="classNFcore_1_1ReactantTree.html#12da0834fff7d487a8f42292e7f325ae">ReactantTree</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classNFcore_1_1ReactantTree.html#d1f496c045d8653b32c68843696d7ada">reactantIndex</a>, <a class="code" href="classNFcore_1_1TransformationSet.html" title="Maintains a set of Transformation objects for a ReactionClass.">TransformationSet</a> *<a class="code" href="classNFcore_1_1ReactantTree.html#c1428823f5ce0c2da03b9add496e13c9">ts</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> init_capacity);
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 
<a name="l00047"></a>00047                         <span class="keyword">virtual</span> <a class="code" href="classNFcore_1_1ReactantTree.html#aa3f46617dea88f5c2c8c9289bccd991">~ReactantTree</a>();
<a name="l00048"></a>00048 
<a name="l00052"></a><a class="code" href="classNFcore_1_1ReactantTree.html#ef1e9f23adf8a29de2d011655c1ed13d">00052</a>                         <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classNFcore_1_1ReactantTree.html#ef1e9f23adf8a29de2d011655c1ed13d">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classNFcore_1_1ReactantTree.html#879ca3d3ae77fc230370d22f0e5d0e2b">n_mappingSets</a>; };
<a name="l00053"></a>00053 
<a name="l00063"></a>00063                         <span class="keyword">virtual</span> <a class="code" href="classNFcore_1_1MappingSet.html" title="Keeps a list of mappings needed by a particular list of reactants.">MappingSet</a> * <a class="code" href="classNFcore_1_1ReactantTree.html#e4d30fa34fd659adacef3e11a6042a2a">pushNextAvailableMappingSet</a>();
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 
<a name="l00071"></a>00071                         <span class="keywordtype">void</span> <a class="code" href="classNFcore_1_1ReactantTree.html#746fcc68505724658fc30fb282fcc2d7">confirmPush</a>(<span class="keywordtype">int</span> mappingSetId, <span class="keywordtype">double</span> rateFactor);
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 
<a name="l00079"></a>00079                         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classNFcore_1_1ReactantTree.html#6fab52e4e443fa84cd9c8235f6d21219">popLastMappingSet</a>();
<a name="l00080"></a>00080 
<a name="l00085"></a>00085                         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classNFcore_1_1ReactantTree.html#4428df5b215ef01bd3371191381719b4">removeMappingSet</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mappingSetId);
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 
<a name="l00092"></a>00092                         <span class="keywordtype">void</span> <a class="code" href="classNFcore_1_1ReactantTree.html#0ee274538b6a1e751ac8beea773ed79d">pickReactantFromValue</a>(<a class="code" href="classNFcore_1_1MappingSet.html" title="Keeps a list of mappings needed by a particular list of reactants.">MappingSet</a> *&amp;ms, <span class="keywordtype">double</span> value, <span class="keywordtype">double</span> baseRate);
<a name="l00093"></a>00093 
<a name="l00098"></a>00098                         <span class="keywordtype">void</span> <a class="code" href="classNFcore_1_1ReactantTree.html#0af2332db552c7fc4a80616ef0e5636d">updateValue</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mappingSetId, <span class="keywordtype">double</span> newRateFactor);
<a name="l00099"></a>00099 
<a name="l00103"></a>00103                         <span class="keyword">virtual</span> <a class="code" href="classNFcore_1_1MappingSet.html" title="Keeps a list of mappings needed by a particular list of reactants.">MappingSet</a> * <a class="code" href="classNFcore_1_1ReactantTree.html#210de2e1db684b548aee6e3f8519ec67">getMappingSet</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mappingSetId) <span class="keyword">const</span>;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 
<a name="l00111"></a>00111                         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classNFcore_1_1ReactantTree.html#1824b471b5e766908f8a63f8e6ab347d">printDetails</a>() <span class="keyword">const</span>;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 
<a name="l00120"></a><a class="code" href="classNFcore_1_1ReactantTree.html#bb9dee084a3bd0a6c9b6957c68c0865e">00120</a>                         <span class="keywordtype">double</span> <a class="code" href="classNFcore_1_1ReactantTree.html#bb9dee084a3bd0a6c9b6957c68c0865e">getRateFactorSum</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classNFcore_1_1ReactantTree.html#55f4c51ac3c0b426cce2b562c89c7d15">leftRateFactorSum</a>[0]; };
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 
<a name="l00126"></a><a class="code" href="classNFcore_1_1ReactantTree.html#98c28c19e8cd616555afc6fabe975107">00126</a>                         <span class="keywordtype">int</span> <a class="code" href="classNFcore_1_1ReactantTree.html#98c28c19e8cd616555afc6fabe975107">getDepthOfTree</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classNFcore_1_1ReactantTree.html#90870dc3688a7f7b2be5dbd90b6f7b2d">treeDepth</a>; };
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 
<a name="l00129"></a>00129                 <span class="keyword">protected</span>:
<a name="l00130"></a>00130 
<a name="l00135"></a>00135                         <span class="keywordtype">void</span> <a class="code" href="classNFcore_1_1ReactantTree.html#b9a70aa9798b413ccd8a44d756aeb88d">removeFromTreeOnly</a>(<span class="keywordtype">int</span> msTreeArrayPosition, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mappingSetId);
<a name="l00136"></a>00136 
<a name="l00142"></a>00142                         <span class="keywordtype">void</span> <a class="code" href="classNFcore_1_1ReactantTree.html#32d694cd16becbce5f75b38bc08c773c">expandTree</a>(<span class="keywordtype">int</span> newCapacity);
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 
<a name="l00145"></a><a class="code" href="classNFcore_1_1ReactantTree.html#c1428823f5ce0c2da03b9add496e13c9">00145</a>                         <a class="code" href="classNFcore_1_1TransformationSet.html" title="Maintains a set of Transformation objects for a ReactionClass.">TransformationSet</a> *ts;       <span class="comment">//Keeps track of the set of transformations</span>
<a name="l00146"></a><a class="code" href="classNFcore_1_1ReactantTree.html#d1f496c045d8653b32c68843696d7ada">00146</a>                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> reactantIndex;  <span class="comment">//the index of the tree</span>
<a name="l00147"></a>00147 
<a name="l00148"></a>00148                         <span class="comment">//Basic tree parameters and constants</span>
<a name="l00149"></a><a class="code" href="classNFcore_1_1ReactantTree.html#98df829058fc764be8d85245000aafe0">00149</a>                         <span class="keywordtype">int</span> <a class="code" href="classNFcore_1_1ReactantTree.html#98df829058fc764be8d85245000aafe0">maxElementCount</a>;
<a name="l00150"></a><a class="code" href="classNFcore_1_1ReactantTree.html#90870dc3688a7f7b2be5dbd90b6f7b2d">00150</a>                         <span class="keywordtype">int</span> <a class="code" href="classNFcore_1_1ReactantTree.html#90870dc3688a7f7b2be5dbd90b6f7b2d">treeDepth</a>;
<a name="l00151"></a><a class="code" href="classNFcore_1_1ReactantTree.html#11514f01532f7b0f286df1e4d806e3b2">00151</a>                         <span class="keywordtype">int</span> <a class="code" href="classNFcore_1_1ReactantTree.html#11514f01532f7b0f286df1e4d806e3b2">numOfNodes</a>;
<a name="l00152"></a>00152 
<a name="l00153"></a>00153                         <span class="comment">//The tree stored as 3 arrays indexed as:</span>
<a name="l00154"></a>00154                         <span class="comment">// Children are at 2i and 2i+1</span>
<a name="l00155"></a>00155                         <span class="comment">// Parent is at i/2 (using integer division)</span>
<a name="l00156"></a>00156                         <span class="comment">// root is at index 1</span>
<a name="l00157"></a>00157                         <span class="comment">// index 0 is empty and always zero</span>
<a name="l00158"></a><a class="code" href="classNFcore_1_1ReactantTree.html#55f4c51ac3c0b426cce2b562c89c7d15">00158</a>                         <span class="keywordtype">double</span> * <a class="code" href="classNFcore_1_1ReactantTree.html#55f4c51ac3c0b426cce2b562c89c7d15">leftRateFactorSum</a>;
<a name="l00159"></a><a class="code" href="classNFcore_1_1ReactantTree.html#ba8b6fb6ace2e341974441bac27995b7">00159</a>                         <span class="keywordtype">int</span> * <a class="code" href="classNFcore_1_1ReactantTree.html#ba8b6fb6ace2e341974441bac27995b7">leftElementCount</a>;
<a name="l00160"></a><a class="code" href="classNFcore_1_1ReactantTree.html#35f6898d939641c2aaf4990f2718e4d8">00160</a>                         <span class="keywordtype">int</span> * <a class="code" href="classNFcore_1_1ReactantTree.html#35f6898d939641c2aaf4990f2718e4d8">rightElementCount</a>;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162                         <span class="comment">//The actual list of mappingSets, stored as a list</span>
<a name="l00163"></a><a class="code" href="classNFcore_1_1ReactantTree.html#c3ce03b2b2393165af3800ea34aed956">00163</a>                         <a class="code" href="classNFcore_1_1MappingSet.html" title="Keeps a list of mappings needed by a particular list of reactants.">MappingSet</a> ** <a class="code" href="classNFcore_1_1ReactantTree.html#c3ce03b2b2393165af3800ea34aed956">mappingSets</a>;
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 
<a name="l00166"></a>00166 
<a name="l00169"></a>00169 
<a name="l00170"></a>00170                         <span class="comment">//Given a mappingSet Id, this tells us what position it is in</span>
<a name="l00171"></a>00171                         <span class="comment">//in the mappingSets array</span>
<a name="l00172"></a><a class="code" href="classNFcore_1_1ReactantTree.html#dab36f1618fcbc21352d95989432214f">00172</a>                         <span class="keywordtype">int</span> * <a class="code" href="classNFcore_1_1ReactantTree.html#dab36f1618fcbc21352d95989432214f">msPositionMap</a>;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174                         <span class="comment">//Given a mappingSet Id, this tells us what position it is in</span>
<a name="l00175"></a>00175                         <span class="comment">//in the actual tree</span>
<a name="l00176"></a><a class="code" href="classNFcore_1_1ReactantTree.html#6e59dc3313cbe0491d401cc9cf7c1a14">00176</a>                         <span class="keywordtype">int</span> * <a class="code" href="classNFcore_1_1ReactantTree.html#6e59dc3313cbe0491d401cc9cf7c1a14">msTreePositionMap</a>;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178                         <span class="comment">//Given a tree position index, this tells us the mappingSet Id</span>
<a name="l00179"></a>00179                         <span class="comment">//which we can use to get our mappingSet out of the mappingSets array</span>
<a name="l00180"></a><a class="code" href="classNFcore_1_1ReactantTree.html#8a89ac522a999fdcb4c3e4df60b7f0a5">00180</a>                         <span class="keywordtype">int</span> * <a class="code" href="classNFcore_1_1ReactantTree.html#8a89ac522a999fdcb4c3e4df60b7f0a5">reverseMsTreePositionMap</a>;
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 
<a name="l00183"></a>00183                         <span class="comment">//The number of mappingSets currently set</span>
<a name="l00184"></a><a class="code" href="classNFcore_1_1ReactantTree.html#879ca3d3ae77fc230370d22f0e5d0e2b">00184</a>                         <span class="keywordtype">int</span> <a class="code" href="classNFcore_1_1ReactantTree.html#879ca3d3ae77fc230370d22f0e5d0e2b">n_mappingSets</a>;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186                         <span class="comment">//The index of the first molecule in the tree</span>
<a name="l00187"></a><a class="code" href="classNFcore_1_1ReactantTree.html#484daa5c6461995e503b78e293e902ab">00187</a>                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classNFcore_1_1ReactantTree.html#484daa5c6461995e503b78e293e902ab">firstMappingTreeIndex</a>;
<a name="l00188"></a>00188         };
<a name="l00189"></a>00189 }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 <span class="preprocessor">#endif </span><span class="comment">/* REACTANTTREE_HH_ */</span>
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Thu Dec 9 11:02:48 2010 for NFsim by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
